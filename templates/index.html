<!DOCTYPE html>
<html lang="en">
 
<head>
    <title>Why are flags at half mast?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Slabo+27px|Source+Sans+Pro" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<meta property="og:url" content="http://halfmast.ca"/>
    <meta property="og:title" content="Why are Canadian flags at half mast?" />
    <meta property="og:description" content="Canadian half-masting notices." />
    <meta property="og:image" content="http://www.halfmast.ca/static/socialhalfmast.jpg" /> 
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@halfmastcanada" />
    <meta name="twitter:title" content="Why are Canadian flags at half mast?" />
    <meta name="twitter:description" content="Canadian half-masting notices." />
    <meta name="twitter:image" content="http://www.halfmast.ca/static/socialhalfmast.jpg" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">

</head>
 
<body>

	<div id="fb-root"></div>
	<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	  if (d.getElementById(id)) return;
	  js = d.createElement(s); js.id = id;
	  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.8";
	  fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>

	<div id="firstContainer">

		<div id="intro">

			<h1>Why are Canadian flags at half mast?</h1>
			<h2><i class="fa fa-quote-left" aria-hidden="true"></i> Given that such flags are recognized as paramount symbols of their nations, the act of half-masting is a dramatic visual statement that speaks to the sense of loss that is shared by all their citizens. <i class="fa fa-quote-right" aria-hidden="true"></i>
	<br> â€“ <small>Canadian Heritage website</small></h2>
		</div>

		<div id="container">

			<div class="current">

			</div>

			<div id="intro2">

			<h3>This site visualizes and lists the Canadian government's <a target="_blank" href="http://canada.pch.gc.ca/eng/1461849633127">half-masting notices</a> and the rules that are cited.</h3>

			</div>

			<div id="chartContain">
				<h3>Rules cited in half-masting notices</h3>
				<p>Half-mastings by rules, April 16, 2011 to present</p>

				<div id="wrapper"></div>

				<div id="rules">
				<h3>The rules</h3>
				<ol>
					<h4>Mandatory Half-Mastings:</h4>
					<li>The Sovereign, the Governor General and the Prime Minister<span class="rule1"></span></li>
					<li>Sovereign's Family<span class="rule2"></span></li>
					<li>Former Prime Minister<span class="rule3"></span></li>
					<li>Former Governor General<span class="rule4"></span></li>
					<li>Chief Justice of Canada and Members of the Canadian Ministry<span class="rule5"></span></li>
					<li>Lieutenant Governors<span class="rule6"></span> </li>
					<li>Privy Councillors and Senators <span class="rule7"></span></li>
					<li>Members of the House of Commons <span class="rule8"></span></li>
					<li>Accredited Heads of Mission to Canada while in Canada <span class="rule9"></span></li>
					<li>Half-Masting Initiated by a Province or Territory <span class="rule10"></span></li>
					<li>Special Days <span class="rule11"></span></li>
					<h4>Discretionary Provisions:</h4>
					<li>Foreign Heads of State or Heads of Government - Half-masting Abroad <span class="rule12"></span></li>
					<li>Special Circumstances in a Foreign Country <span class="rule13"></span></li>
					<li>Employees of the Federal Government <span class="rule14"></span></li>
					<h4>Discretionary Authority of the Prime Minister</h4>
					<li>Foreign Heads of State or Heads of Government - Half-masting in Canada <span class="rule15"></span></li>
					<li>Exceptional Circumstances <span class="rule16"></span></li>
					<li>Delegation of Authority<span class="rule17"></span></li>
					<li>Information from the Department of Canadian Heritage <span class="rule18"></span></li>
					<h4>Procedures</h4>
					<li>Legal Holidays<span class="rule19"></span></li>
					<li>Visiting Foreign Head of State or Head of Government <span class="rule20"></span></li>
					<li>Exceptions to Sections 19 and 20 <span class="rule21"></span></li>
					<li>Half-Masting Notice <span class="rule22"></span></li>
					<li>Coming into Effect<span class="rule23"></span></li>
					<h4>Multiple sections cited <span class="ruleMultiple"></span></h4>
				</ol>
				</div>

			</div>

			<div class="yearcontainernow">
			<h3>2018</h3>

				<div class="currentyear big">

				</div>
			</div>

			<div id="calendarContain">
				<div id="calendar_basic"></div>
				<p>*Indicates more than one half-masting on a day <span class="s25"></span></p>
			</div>

			<h3>Previous years</h3>
			
						<div class="yearcontainer">
				<h3>2017 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2017">
				</div>
			</div>


			<div class="yearcontainer">
				<h3>2016 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2016">
				</div>
			</div>

			<div class="yearcontainer">
			<h3>2015 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2015">
				</div>
			</div>

			<div class="yearcontainer">
				<h3>2014 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2014">
				</div>
			</div>

			<div class="yearcontainer">
				<h3>2013 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2013">
				</div>
			</div>

			<div class="yearcontainer">
				<h3>2012 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2012">
				</div>
			</div>


			<div class="yearcontainer">
				<h3>2011 <i class="fa fa-chevron-down" aria-hidden="true"></i>
	</h3>
				<div class="year2011">
				</div>
			</div>

		{% for row in rows %}

					{% if row.happening == True %}
						<div class="current_masting masting">
						<h3 id="current">Current half-masting:</h3>
						<h3> {{ row.title }}</h3>

						<a class="twitter-share-button"
						  href="https://twitter.com/intent/tweet?text=Flags%20are%20at%20half%20mast%20for%20{{row.title}}">Tweet</a>

						  <div class="fb-share-button" data-href="http://halfmast.ca" data-layout="button_count" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fhalfmast.ca%2F&amp;src=sdkpreparse">Share</a></div>

					{% endif %}

					{% if row.happening == False and row.currentyear == row.year %}
						<div class="current_year masting">
						<h3>{{ row.title }}</h3>
					{% endif %}
							
					{% if row.year == "2017" %}
						<div class="masting2017 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}

					{% if row.year == "2016" %}
						<div class="masting2016 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}

					{% if row.year == "2015" %}
						<div class="masting2015 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}

					{% if row.year == "2014" %}
						<div class="masting2014 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}
				
					{% if row.year == "2013" %}
						<div class="masting2013 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}

					{% if row.year == "2012" %}
						<div class="masting2012 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}

					{% if row.year == "2011" %}
						<div class="masting2011 masting">
						<h3>{{ row.title }}</h3>
					{% endif %}

						<p><strong>When: </strong>{{ row.mastingperiod }}</p>
						<p><strong>Where: </strong>{{ row.location }}</p>
						<p><strong>Rule cited:</strong>

						{{row.section}} <span class="rule{{row.section}} s{{row.section}} legend"></span>

						</p>
					</div>

			{% endfor %}

		</div>

		<footer>
			<p>Made by <a target="_blank" href="http://carysmills.com/">Carys Mills</a>.</p>
			<div id="socialContainer">

				<a class="twitter-share-button"
				  href="https://twitter.com/intent/tweet?text=Why%20are%20Canadian%20flags%20at%20half%20mast">Tweet</a>

				  <div class="fb-share-button" data-href="http://halfmast.ca" data-layout="button_count" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fhalfmast.ca%2F&amp;src=sdkpreparse">Share</a></div>

			</div>
		</footer>

	</div>

	<script
	  src="https://code.jquery.com/jquery-3.2.1.min.js"
	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	  crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.2/Chart.min.js"></script>
	<script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='scripts.js') }}"></script>

	<script>

	var month = new Array();
	month[0] = "January";
	month[1] = "February";
	month[2] = "March";
	month[3] = "April";
	month[4] = "May";
	month[5] = "June";
	month[6] = "July";
	month[7] = "August";
	month[8] = "September";
	month[9] = "October";
	month[10] = "November";
	month[11] = "December";

	google.charts.load("current", {packages:["calendar"]});
	      google.charts.setOnLoadCallback(drawChart);

	   function drawChart() {
	       var dataTable = new google.visualization.DataTable();
	       dataTable.addColumn('date', 'Date' );
	       dataTable.addColumn('number', 'Section');
	       dataTable.addColumn({'type': 'string', 'role': 'tooltip', 'p': {'html': true}})

	       var dates = [];

	       {% for row in rows %}

	       	if ({{row.year}} == 2016) {	

	       		// take zeros off date, convert
	       		var date1 = "{{ row.date1}}".replace(/\s.*/g, '');
	       		date1 = new Date(date1);
	       		var newdate1 = new Date(date1);
	       		date1.setDate(date1.getDate() + 1);

	       		var date2 = "{{ row.date2 }}";

	       		// DATE RANGE
	       		if (date2 !== "NA") {
	       			date2 = date2.replace(/\s.*/g, '');
	       			date2 = new Date(date2);
	       			var newdate2 = new Date(date2);
	       			date2.setDate(date2.getDate() + 1);
	       			
	       			var timeDiff = Math.abs(date2.getTime() - date1.getTime());
	       			var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24)); 

	       			for (i=0; i < (diffDays + 1); i++) {
	       				diffdate = new Date(date1 - 1);
	       				var newdiffdate = diffdate;
	       				diffdate.setDate(diffdate.getDate() + i);

	       				var dateString=diffdate;
	       				dateString=new Date(dateString).toUTCString();
	       				dateString=dateString.split(' ').slice(0, 4).join(' ')

	       				if (dates.includes(diffdate.toString())) {
	       					section = 31;
	       					dataTable.addRows([
	       					   [ diffdate, section,"<div class='tooltip'><strong>Multiple half-mastings</strong><br><strong>Date:</strong> " + dateString + "</div>" ],
	       					 ]);
	       				}

	       				else {
	       					var section = "{{ row.section }}".replace("Multiple",30);
	       					section = parseInt(section);

	       					dataTable.addRows([
	       					   [ diffdate, section,"<div class='tooltip'><strong>Occasion</strong>: {{row.title}} <br><strong>Rule cited:</strong> {{row.section}} <br> <strong>Location(s)</strong>: {{ row.location }} <br> <strong>Dates:</strong> " + dateString + "</div>" ],
	       					 ]);
	       				}
	       				dates.push(diffdate.toString());
	       			} 
	       		}

	       		// ONLY ONE DAY
	       		else {

	       			var dateString1=date1;
	       			dateString1=new Date(dateString1).toUTCString();
	       			dateString1=dateString1.split(' ').slice(0, 4).join(' ')

	       			if (dates.includes(date1.toString())) {
	       				date2 == "NA";
	       				section = 31;
	       				dataTable.addRows([
	       				   [ date1, section,"<div class='tooltip'><strong>Multiple half-mastings</strong> <br> <strong>Location(s)</strong>: {{ row.location }} <br><strong>Date:</strong> " + dateString1 + "</div>"],
	       				 ]);
	       			}

	       			else {
	       				date2 == "NA";

	       				var section = "{{ row.section }}".replace("Multiple",30);
	       				section = parseInt(section);

	       				dataTable.addRows([
	       				   [ date1, section,"<div class='tooltip'><strong>Occasion:</strong> {{row.title}} <br> <strong>Rule cited:</strong> {{row.section}} <br> <strong>Location(s)</strong>: {{ row.location }} <br> <strong>Date:</strong> " + dateString1 + "</div>"],
	       				 ]);
	       			}
	       			dates.push(date1.toString());
	       		}	

	       	}

	       {% endfor%}

	       dataTable.addRows([
	          [ new Date("July 1 2016"), 19,"<div class='tooltip'><strong>Occasion:</strong> Canada Day<br> <strong>Rule cited: 19</strong> The flag must be flown at full-mast.</strong></div>"],
	          [ new Date("May 23 2016"), 19,"<div class='tooltip'><strong>Occasion:</strong> Victoria Day<br> <strong>Rule cited: 19</strong> The flag must be flown at full-mast.</div>"],
	        ]);

	       var chart = new google.visualization.Calendar(document.getElementById('calendar_basic'));

	       var options = {
	       	tooltip: {isHtml: true},
	         title: "Last year's half mastings",
	         height: Math.min(($(window).width() / 3.7), 280),
	         calendar: { 
	         	focusedCellColor: {
	         	      stroke: 'grey',
	         	      strokeOpacity: 0.2,
	         	      strokeWidth: 1,
	         	    },
	         	cellSize: $(window).width() * 0.015,
	         	monthLabel: {
	         	       fontName: 'Slabo 27px',
	         	       fontSize: 12,
	         	       color: '#000',
	         	       bold: true,
	         	     },
	         	monthOutlineColor: {
	         	   strokeWidth: 1.5
	         	 },
	         	yearLabel: {
	         	       fontName: 'Source Sans Pro',
	         	       fontSize: 32,
	         	        color: '#000',
	         	        bold: true,
	         	      }
	         },
	         colorAxis: {values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 30, 31],
	         	colors: [	       
	        "#FFFF00",
	        "#1CE6FF",
	        "#FF34FF",
	        "#008941",
	        "#006FA6",
	        "#A30059",
	        "#63FFAC",
	        "#B79762",
	        "#997D87",
	        "#FFB500",
	        "#C2FFED",
	        "#7900D7",
	        "#D25B88",
	        "#6C5E46",
	        "#6C8F7D",
	        "#BDC9D2",
	        "#EA8B66",
	        "#00C6C8",
	        "#fff",
	        "#B894A6",
	        "#006A66",
	        "#F4D749",
	       	"#6B94AA",
	       	"#00005F",
	       	"#bada55",
	       	]}
	       };
	       chart.draw(dataTable, options);
	   }

	</script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-69057817-3', 'auto');
	  ga('send', 'pageview');

	</script>

	<script>window.twttr = (function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0],
		    t = window.twttr || {};
		  if (d.getElementById(id)) return t;
		  js = d.createElement(s);
		  js.id = id;
		  js.src = "https://platform.twitter.com/widgets.js";
		  fjs.parentNode.insertBefore(js, fjs);
		  t._e = [];
		  t.ready = function(f) {
		    t._e.push(f);
		  };
		  return t;
		}(document, "script", "twitter-wjs"));
	</script>

</body>
 
</html>
